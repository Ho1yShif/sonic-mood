# 🎵 Sonic Mood

A modern, AI-powered music recommendation web application that demonstrates how to build beautiful frontends for pgvector-powered backends on Render. Users describe the music they want in natural language, and the app returns personalized song recommendations with AI-generated playlist names.

![Sonic Mood](https://img.shields.io/badge/React-19.1-blue) ![TypeScript](https://img.shields.io/badge/TypeScript-5.9-blue) ![Tailwind CSS](https://img.shields.io/badge/Tailwind-4.1-blue) ![License](https://img.shields.io/badge/license-MIT-green)

## 🌟 Features

- **Natural Language Search**: Describe the music you want in plain English
- **Semantic Search**: Powered by pgvector in Render Postgres for intelligent song matching
- **AI-Generated Playlists**: Creative playlist names generated by OpenAI
- **Beautiful UI**: Modern, sleek design with purple/black theme
- **Fully Responsive**: Works seamlessly on mobile, tablet, and desktop
- **Accessible**: WCAG 2.1 compliant with keyboard navigation and screen reader support
- **Mock Data Mode**: Develop without a backend using realistic mock data
- **Production Ready**: Optimized for deployment on Render

## 🏗️ Architecture

This application demonstrates best practices for building React frontends that work with pgvector-powered backends:

### Frontend Stack
- **React 19** - Modern UI library with hooks
- **TypeScript** - Type-safe development
- **Vite** - Lightning-fast build tool
- **Tailwind CSS** - Utility-first styling
- **React Icons** - Beautiful icon library

### Backend Integration
The backend (not included in this repo) uses:
- **Render Postgres with pgvector** - Vector similarity search on song embeddings
- **OpenAI API** - Embedding generation and playlist naming
- **Express/Fastify** - API server

### How It Works

1. **User Input**: User describes desired music in natural language
2. **Embedding Generation**: Backend generates a vector embedding of the query
3. **Semantic Search**: pgvector finds the most similar songs in Postgres
4. **Results**: Top 5 songs returned with metadata
5. **Playlist Naming**: OpenAI generates a creative playlist name based on the songs

```
┌─────────────┐         ┌─────────────┐         ┌──────────────┐
│   Frontend  │────────▶│   Backend   │────────▶│   Postgres   │
│   (React)   │  HTTP   │  (Express)  │  SQL    │  (pgvector)  │
└─────────────┘         └─────────────┘         └──────────────┘
                               │
                               │ API Call
                               ▼
                        ┌─────────────┐
                        │   OpenAI    │
                        │     API     │
                        └─────────────┘
```

## 📦 Project Structure

```
sonic-mood/
├── src/
│   ├── components/          # Reusable React components
│   │   ├── SearchBar/       # Search input with validation
│   │   ├── SongCard/        # Individual song display
│   │   ├── PlaylistHeader/  # Playlist name display
│   │   ├── LoadingSpinner/  # Loading state
│   │   ├── ErrorMessage/    # Error handling
│   │   └── EmptyState/      # Initial welcome screen
│   ├── hooks/               # Custom React hooks
│   │   └── useRecommendations.ts  # API call management
│   ├── services/            # API communication
│   │   ├── api.ts          # Real API client
│   │   └── mockApi.ts      # Mock data for development
│   ├── mocks/              # Mock data definitions
│   │   └── data.ts         # Sample song data
│   ├── types/              # TypeScript type definitions
│   │   └── index.ts        # Shared interfaces
│   ├── App.tsx             # Main app component
│   ├── App.css             # App-specific styles
│   ├── index.css           # Global styles & Tailwind
│   └── main.tsx            # Entry point
├── public/                 # Static assets
├── .env.example           # Environment variable template
├── render.yaml            # Render deployment config
├── tailwind.config.js     # Tailwind configuration
├── vite.config.ts         # Vite configuration
└── package.json           # Dependencies and scripts
```

## 🚀 Getting Started

### Prerequisites

- Node.js 18+ and npm
- A text editor (VS Code recommended)
- Git

### Installation

1. **Clone the repository**
   ```bash
   git clone <your-repo-url>
   cd sonic-mood
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Set up environment variables**
   ```bash
   cp .env.example .env
   ```

   Edit `.env` to configure your settings:
   ```env
   # Use mock data for development (no backend needed)
   VITE_USE_MOCK_DATA=true
   VITE_API_URL=http://localhost:3000/api
   ```

4. **Start the development server**
   ```bash
   npm run dev
   ```

5. **Open your browser**
   Navigate to `http://localhost:5173`

That's it! The app will run with mock data by default.

### Development with Mock Data

By default, the app uses realistic mock data so you can develop without a backend. The mock API simulates:
- Network latency (500-1000ms)
- Different responses based on query keywords
- Occasional errors (5% chance) for testing error handling
- Validation errors for empty or invalid queries

To switch between mock and real API:
```env
# Use mock data
VITE_USE_MOCK_DATA=true

# Use real backend API
VITE_USE_MOCK_DATA=false
```

### Connecting to a Real Backend

1. Update your `.env` file:
   ```env
   VITE_USE_MOCK_DATA=false
   VITE_API_URL=https://your-backend.onrender.com/api
   ```

2. Ensure your backend has an endpoint at `POST /recommendations` that accepts:
   ```json
   {
     "query": "string (max 500 chars)"
   }
   ```

3. And returns:
   ```json
   {
     "playlistName": "string",
     "recommendations": [
       {
         "id": "string",
         "title": "string",
         "artist": "string",
         "spotifyLink": "string | null"
       }
     ]
   }
   ```

## 🎨 Design System

### Color Palette
- **Primary Purple**: `#8a05ff` - Buttons, accents, highlights
- **Black**: `#000000` - Backgrounds, primary text
- **White**: `#ffffff` - Text on dark backgrounds
- **Grays**: Various shades for secondary text and borders

### Typography
- System fonts for optimal performance
- Clear hierarchy with varying sizes and weights
- Minimum 14px for body text
- Line height 1.6 for readability

### Responsive Breakpoints
- **Mobile**: < 640px
- **Tablet**: 640px - 1024px
- **Desktop**: > 1024px

## 🛠️ Available Scripts

### Development
```bash
npm run dev          # Start development server (port 5173)
npm run build        # Build for production
npm run preview      # Preview production build locally
npm run lint         # Run ESLint
```

### Production Build
```bash
npm run build
```
This creates an optimized production build in the `dist/` directory.

## 📡 API Reference

### POST /recommendations

Fetches song recommendations based on natural language input.

**Request Body:**
```json
{
  "query": "upbeat songs for a workout"
}
```

**Success Response (200):**
```json
{
  "playlistName": "Energetic Workout Vibes",
  "recommendations": [
    {
      "id": "1",
      "title": "Eye of the Tiger",
      "artist": "Survivor",
      "spotifyLink": "https://open.spotify.com/track/..."
    }
    // ... 4 more songs
  ]
}
```

**Error Responses:**
- `400` - Invalid query (empty or > 500 chars)
- `500` - Server error
- `0` - Network error

## 🚢 Deployment to Render

### Option 1: Using render.yaml (Recommended)

1. **Push your code to GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-github-repo>
   git push -u origin main
   ```

2. **Connect to Render**
   - Go to [render.com](https://render.com)
   - Click "New +" → "Static Site"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml`

3. **Configure environment variables**
   In the Render dashboard, set:
   - `VITE_API_URL`: Your backend API URL
   - `VITE_USE_MOCK_DATA`: `false`

4. **Deploy**
   Render will automatically build and deploy your app!

### Option 2: Manual Setup

1. **Create a Static Site on Render**
   - Build Command: `npm install && npm run build`
   - Publish Directory: `dist`

2. **Set environment variables** (see above)

3. **Deploy**

### Automatic Deploys

Render automatically deploys when you push to your main branch. You can also:
- Set up preview environments for pull requests
- Configure custom domains
- Enable automatic HTTPS

## 🔒 Security & Performance

### Security Features
- Content Security Policy headers
- XSS protection
- No inline scripts or styles
- HTTPS enforced in production
- Environment variables for sensitive data

### Performance Optimizations
- Code splitting with Vite
- Tree shaking for smaller bundles
- Lazy loading of components
- Optimized images and assets
- Minimal dependencies

## ♿ Accessibility

This app follows WCAG 2.1 Level AA guidelines:
- ✅ Keyboard navigation support
- ✅ Screen reader friendly
- ✅ Proper ARIA labels and roles
- ✅ Sufficient color contrast
- ✅ Focus indicators
- ✅ Semantic HTML
- ✅ Live regions for dynamic content

## 🧪 Testing

### Manual Testing Checklist
- [ ] Search with various queries
- [ ] Test with empty input
- [ ] Test with very long input (>500 chars)
- [ ] Verify loading states
- [ ] Verify error handling
- [ ] Test Spotify links (available and unavailable)
- [ ] Test responsive design on different screen sizes
- [ ] Test keyboard navigation
- [ ] Test with screen reader

### Error Scenarios
The mock API includes a 5% chance of random errors for testing error handling. To force errors:
- Submit empty query → Validation error
- Submit 501+ character query → Validation error

## 📚 Learning Resources

This project demonstrates:
- **React Best Practices**: Functional components, custom hooks, proper state management
- **TypeScript**: Strong typing, interfaces, type safety
- **API Integration**: Clean service layer, error handling, environment configuration
- **Responsive Design**: Mobile-first approach with Tailwind CSS
- **Accessibility**: WCAG compliance, semantic HTML, ARIA labels
- **Performance**: Code splitting, optimization techniques

## 🤝 Contributing

Contributions are welcome! Here's how to get started:

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/amazing-feature`
3. Commit your changes: `git commit -m 'Add amazing feature'`
4. Push to the branch: `git push origin feature/amazing-feature`
5. Open a Pull Request

Please ensure:
- Code follows the existing style
- TypeScript types are properly defined
- Components are accessible
- The app works with both mock and real data

## 🐛 Troubleshooting

### Build Errors

**Issue**: `Cannot find module 'react-icons'`
```bash
npm install react-icons
```

**Issue**: `Tailwind styles not loading`
```bash
# Ensure tailwind.config.js has correct content paths
# Ensure index.css imports Tailwind directives
```

### Runtime Errors

**Issue**: `API calls failing`
- Check `.env` file exists and has correct values
- Verify `VITE_API_URL` is set correctly
- Try setting `VITE_USE_MOCK_DATA=true` to test with mock data

**Issue**: `Environment variables not working`
- Environment variable names must start with `VITE_`
- Restart dev server after changing `.env`

### Deployment Issues

**Issue**: `Environment variables not set in production`
- Add them in Render dashboard under "Environment"
- Don't use quotes around values in Render UI

## 📄 License

This project is licensed under the MIT License.

## 🙏 Acknowledgments

- Built for Render customers as an educational demo
- Demonstrates pgvector + Render Postgres integration
- Inspired by modern music streaming services
- Uses semantic search for intelligent recommendations

## 📧 Support

For questions or issues:
- Open an issue on GitHub
- Check the troubleshooting section
- Review the architecture documentation
- Contact the maintainers

---

**Built with ❤️ using React, TypeScript, Tailwind CSS, and deployed on Render**

🔗 [Live Demo](#) | 📖 [Documentation](#) | 🐙 [GitHub](#)
